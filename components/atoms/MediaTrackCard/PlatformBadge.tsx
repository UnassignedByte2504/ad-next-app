"use client";

import { forwardRef, type SVGProps } from "react";
import Box from "@mui/material/Box";
import { alpha } from "@mui/material/styles";

import { neutral } from "@/app/ui/theme";

// =============================================================================
// TYPES
// =============================================================================

/**
 * Supported streaming platforms for media embeds.
 */
export type StreamingPlatform =
  | "spotify"
  | "youtube-music"
  | "apple-music"
  | "tidal"
  | "soundcloud";

export type PlatformBadgeSize = "sm" | "md" | "lg";

export interface PlatformBadgeProps {
  /** Streaming platform to display */
  platform: StreamingPlatform;
  /** Badge size */
  size?: PlatformBadgeSize;
  /** Show platform name alongside icon */
  showLabel?: boolean;
  /** Additional CSS class */
  className?: string;
}

// =============================================================================
// PLATFORM CONFIGURATION
// =============================================================================

interface PlatformConfig {
  name: string;
  color: string;
  Icon: React.FC<SVGProps<SVGSVGElement>>;
}

/**
 * SVG Icons for each streaming platform.
 * Using simplified, recognizable brand marks.
 */

const SpotifyIcon: React.FC<SVGProps<SVGSVGElement>> = (props) => (
  <svg viewBox="0 0 24 24" fill="currentColor" {...props}>
    <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z" />
  </svg>
);

const YouTubeMusicIcon: React.FC<SVGProps<SVGSVGElement>> = (props) => (
  <svg viewBox="0 0 24 24" fill="currentColor" {...props}>
    <path d="M12 0C5.376 0 0 5.376 0 12s5.376 12 12 12 12-5.376 12-12S18.624 0 12 0zm0 19.104c-3.924 0-7.104-3.18-7.104-7.104S8.076 4.896 12 4.896s7.104 3.18 7.104 7.104-3.18 7.104-7.104 7.104zm0-13.332c-3.432 0-6.228 2.796-6.228 6.228S8.568 18.228 12 18.228 18.228 15.432 18.228 12 15.432 5.772 12 5.772zM9.684 15.54V8.46L15.816 12l-6.132 3.54z" />
  </svg>
);

const AppleMusicIcon: React.FC<SVGProps<SVGSVGElement>> = (props) => (
  <svg viewBox="0 0 24 24" fill="currentColor" {...props}>
    <path d="M23.994 6.124a9.23 9.23 0 00-.24-2.19c-.317-1.31-1.062-2.31-2.18-3.043a5.022 5.022 0 00-1.877-.726 10.496 10.496 0 00-1.564-.15c-.04-.003-.083-.01-.124-.013H5.986c-.152.01-.303.017-.455.026-.747.043-1.49.123-2.193.364-1.29.44-2.24 1.213-2.906 2.39-.32.564-.5 1.18-.589 1.828-.09.636-.13 1.278-.132 1.92v11.078c.005.42.015.84.062 1.258.085.74.24 1.46.548 2.14.48 1.05 1.217 1.87 2.245 2.418.643.343 1.336.512 2.05.604.605.08 1.215.105 1.826.105h11.474c.377 0 .754-.025 1.128-.064.968-.1 1.88-.34 2.696-.88a5.076 5.076 0 001.748-1.95c.398-.753.573-1.573.654-2.406.05-.5.053-1.004.058-1.508V6.374c0-.083-.005-.166-.01-.25zm-6.92 10.662c0 .507-.074.996-.305 1.453-.343.68-.88 1.147-1.597 1.38-.468.155-.954.207-1.447.16a3.414 3.414 0 01-1.74-.64c-.46-.35-.765-.79-.87-1.34-.08-.41-.06-.82.05-1.22.18-.63.53-1.13 1.08-1.49.4-.27.84-.43 1.32-.5.32-.05.63-.08.95-.12.34-.04.66-.1.98-.17.27-.07.4-.2.4-.5v-.76c0-.33.01-.66-.03-.99-.05-.52-.22-1.01-.63-1.36-.23-.2-.5-.33-.79-.4-.25-.06-.51-.08-.77-.08-.38 0-.75.06-1.09.22-.47.2-.78.53-.94 1-.1.29-.12.6-.12.9H9.72c.01-.48.06-.96.2-1.42.18-.62.5-1.15.95-1.59.64-.63 1.42-.97 2.31-1.09.36-.05.72-.08 1.08-.08.64 0 1.27.09 1.88.31.87.3 1.52.83 1.96 1.63.25.44.38.92.43 1.42.03.36.04.72.04 1.08v4.76h.01z" />
  </svg>
);

const TidalIcon: React.FC<SVGProps<SVGSVGElement>> = (props) => (
  <svg viewBox="0 0 24 24" fill="currentColor" {...props}>
    <path d="M12.012 3.992L8.008 7.996 4.004 3.992 0 7.996l4.004 4.004L8.008 8l4.004 4.004L16.016 8l4.004 4.004L24 8.004l-4.004-4.004-3.98 3.98-4.004-3.988zM12.012 12.004L8.008 16.008 4.004 12.004 0 16.008l4.004 4.004 4.004-4.004 4.004 4.004 4.004-4.004 4.004 4.004L24 16.008l-4.004-4.004-3.98 3.98-4.004-3.98z" />
  </svg>
);

const SoundCloudIcon: React.FC<SVGProps<SVGSVGElement>> = (props) => (
  <svg viewBox="0 0 24 24" fill="currentColor" {...props}>
    <path d="M1.175 12.225c-.051 0-.094.046-.101.1l-.233 2.154.233 2.105c.007.058.05.098.101.098.05 0 .09-.04.099-.098l.255-2.105-.27-2.154c-.009-.06-.05-.1-.099-.1m-.899.828c-.06 0-.091.037-.104.094L0 14.479l.165 1.308c.014.057.045.094.09.094s.089-.037.099-.094l.19-1.308-.19-1.334c-.01-.057-.044-.09-.089-.09m1.83-1.229c-.061 0-.12.045-.12.104l-.21 2.563.225 2.458c0 .06.045.104.106.104.061 0 .12-.044.12-.104l.24-2.458-.24-2.563c0-.06-.059-.104-.12-.104m.945-.089c-.075 0-.135.06-.15.135l-.193 2.64.21 2.544c.016.077.075.138.149.138.075 0 .135-.061.15-.138l.225-2.544-.225-2.64c-.016-.075-.075-.135-.15-.135m.93-.135c-.09 0-.149.075-.165.165l-.195 2.775.195 2.52c.016.09.075.165.165.165.09 0 .165-.075.165-.165l.225-2.52-.225-2.775c0-.09-.075-.165-.165-.165m1.035.18c0-.104-.09-.194-.194-.194-.09 0-.18.09-.195.194l-.18 2.775.18 2.52c.015.09.105.18.195.18.09 0 .18-.09.195-.18l.194-2.52-.195-2.775m.75-.555c-.105 0-.195.09-.21.195l-.165 3.15.165 2.505c.015.104.105.195.21.195.09 0 .195-.09.21-.195l.165-2.505-.165-3.15c-.015-.105-.12-.195-.21-.195m.87-.135c-.12 0-.225.104-.225.224l-.15 3.285.15 2.49c0 .12.105.225.225.225.12 0 .225-.105.225-.225l.15-2.49-.15-3.285c0-.12-.105-.224-.225-.224m1.845-.285c0-.135-.105-.24-.24-.24-.119 0-.239.105-.239.24l-.15 3.57.15 2.475c0 .12.12.24.239.24.136 0 .24-.12.24-.24l.165-2.475-.165-3.57m1.005.135c-.135 0-.255.105-.27.255l-.12 3.42.12 2.46c.015.135.135.255.27.255.135 0 .255-.12.255-.255l.135-2.46-.135-3.42c-.015-.15-.12-.255-.255-.255m.885-.555c-.15 0-.27.12-.285.27L8.94 14.46l.105 2.445c.015.15.135.27.285.27.135 0 .255-.12.27-.27l.12-2.445-.12-3.54c-.015-.15-.135-.27-.27-.27m1.185.045c-.165 0-.3.135-.3.3L9.075 14.4l.105 2.43c0 .165.135.3.3.3.15 0 .285-.135.3-.3l.105-2.43-.105-3.69c-.015-.165-.15-.3-.3-.3m.96-.075c-.18 0-.315.15-.315.315l-.09 3.765.09 2.415c0 .165.135.315.315.315.165 0 .315-.15.315-.315l.09-2.415-.09-3.765c0-.165-.15-.315-.315-.315m1.17 0c-.195 0-.33.15-.345.33l-.075 3.75.075 2.4c.015.18.15.33.345.33.18 0 .33-.15.33-.33l.09-2.4-.09-3.75c0-.18-.15-.33-.33-.33m1.185.15c-.195 0-.345.15-.36.345l-.06 3.6.06 2.385c.015.195.165.345.36.345.18 0 .345-.15.345-.345l.075-2.385-.075-3.6c0-.195-.165-.345-.345-.345m1.215.66c-.21 0-.375.165-.375.375l-.045 2.61.045 2.355c0 .21.165.375.375.375.195 0 .375-.165.375-.375l.06-2.355-.06-2.61c0-.21-.18-.375-.375-.375m.93-1.785c-.21 0-.39.18-.39.39l-.06 4.395.06 2.34c0 .21.18.39.39.39.195 0 .39-.18.39-.39l.06-2.34-.06-4.395c0-.21-.195-.39-.39-.39m1.2-.045c-.225 0-.405.18-.405.405l-.06 4.44.06 2.325c0 .225.18.405.405.405.21 0 .405-.18.405-.405l.06-2.325-.06-4.44c0-.225-.195-.405-.405-.405m1.215.12c-.24 0-.42.18-.42.42l-.045 4.32.045 2.31c0 .225.18.42.42.42.225 0 .42-.195.42-.42l.06-2.31-.06-4.32c0-.24-.195-.42-.42-.42m1.23.165c-.24 0-.435.195-.435.435l-.045 4.155.045 2.295c0 .24.195.435.435.435.225 0 .435-.195.435-.435l.045-2.295-.045-4.155c0-.24-.21-.435-.435-.435m1.635 2.355c-.57 0-1.11.105-1.605.3a5.13 5.13 0 00-5.07-4.425c-.659 0-1.29.12-1.86.345-.225.09-.285.18-.3.36v8.715c.016.195.165.345.36.36h8.475c1.41 0 2.55-1.14 2.55-2.55s-1.14-2.555-2.55-2.555" />
  </svg>
);

/**
 * Platform-specific configurations including brand colors.
 */
const platformConfigs: Record<StreamingPlatform, PlatformConfig> = {
  spotify: {
    name: "Spotify",
    color: "#1DB954",
    Icon: SpotifyIcon,
  },
  "youtube-music": {
    name: "YouTube Music",
    color: "#FF0000",
    Icon: YouTubeMusicIcon,
  },
  "apple-music": {
    name: "Apple Music",
    color: "#FA243C",
    Icon: AppleMusicIcon,
  },
  tidal: {
    name: "Tidal",
    color: "#000000",
    Icon: TidalIcon,
  },
  soundcloud: {
    name: "SoundCloud",
    color: "#FF5500",
    Icon: SoundCloudIcon,
  },
};

// =============================================================================
// SIZE CONFIGURATION
// =============================================================================

const sizeConfig: Record<
  PlatformBadgeSize,
  {
    iconSize: number;
    padding: number;
    fontSize: string;
  }
> = {
  sm: {
    iconSize: 14,
    padding: 4,
    fontSize: "0.65rem",
  },
  md: {
    iconSize: 16,
    padding: 6,
    fontSize: "0.75rem",
  },
  lg: {
    iconSize: 20,
    padding: 8,
    fontSize: "0.8rem",
  },
};

// =============================================================================
// COMPONENT
// =============================================================================

/**
 * PlatformBadge - Displays streaming platform icon with optional label.
 *
 * Shows a compact badge with the platform's brand icon and color.
 * Can optionally display the platform name alongside the icon.
 *
 * @example
 * ```tsx
 * // Icon only
 * <PlatformBadge platform="spotify" size="md" />
 *
 * // With label
 * <PlatformBadge platform="apple-music" showLabel />
 * ```
 */
export const PlatformBadge = forwardRef<HTMLDivElement, PlatformBadgeProps>(
  ({ platform, size = "md", showLabel = false, className }, ref) => {
    const config = platformConfigs[platform];
    const sizeStyles = sizeConfig[size];

    if (!config) {
      return null;
    }

    const { Icon, color, name } = config;

    return (
      <Box
        ref={ref}
        className={className}
        sx={{
          display: "inline-flex",
          alignItems: "center",
          gap: 0.5,
          px: showLabel ? `${sizeStyles.padding + 2}px` : `${sizeStyles.padding}px`,
          py: `${sizeStyles.padding - 2}px`,
          borderRadius: showLabel ? "999px" : `${sizeStyles.padding}px`,
          bgcolor: alpha(color, 0.15),
          color: color,
          transition: "all 0.2s ease",
          "&:hover": {
            bgcolor: alpha(color, 0.25),
          },
        }}
        title={name}
      >
        <Icon
          style={{
            width: sizeStyles.iconSize,
            height: sizeStyles.iconSize,
          }}
        />
        {showLabel && (
          <Box
            component="span"
            sx={{
              fontSize: sizeStyles.fontSize,
              fontWeight: 500,
              lineHeight: 1,
              color: neutral[200],
            }}
          >
            {name}
          </Box>
        )}
      </Box>
    );
  }
);

PlatformBadge.displayName = "PlatformBadge";

export default PlatformBadge;
